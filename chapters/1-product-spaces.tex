\chapter{Product spaces}
\section{Product \texorpdfstring{$\sigma$-algebras}{sigma-algebra}} \label{sec:prod-sigma-algebras}

We start with a comparison between product topologies and product $\sigma$-algebras. %See \cite[Sections 4.1 and 4.2]{folland1999} for a review of bases, subbases and product topologies.

For topological spaces $(X_\alpha,\mathcal{T}_\alpha)$ ($\alpha \in I$), recall that the \df{product topology} $\mathcal{T}$ on $X = \prod_{\alpha \in I} X_\alpha$ is the topology generated by all coordinate projections $\pi_\alpha\colon X \to X_\alpha$ (i.e., the smallest topology on $X$ that makes all these maps continuous). Explicitly $\mathcal T$ is generated by the collection of subbasic sets \begin{equation} \label{eq:1d-cylinder-top}
    \{\pi_\alpha^{-1}(U_\alpha): U_\alpha\in \mathcal{T}_\alpha, \alpha \in I\}.
\end{equation}
    
For measurable spaces $(X_\alpha, \A_\alpha)$ ($\alpha \in I$), the \df[product sigma-algebra@product $\sigma$-algebra]{product $\sigma$-algebra} $\A = \bigotimes_{\alpha\in I} \A_\alpha$ on $X = \prod_{\alpha \in I} X_\alpha$ is the $\sigma$-algebra generated by all coordinate projections $\pi_\alpha$. Explicitly $\A$ is generated by the collection of sets \begin{equation} \label{eq:1d-cylinder-sa}
     \{\pi_\alpha^{-1}(E_\alpha): E_\alpha\in \A_\alpha, \alpha \in I\}.
\end{equation}

Define the general \df[cylinder set]{cylinder sets}\footnote{This definition similarly holds for other set-collection pairs.} on the product of topological spaces $(X_\alpha,\mathcal{T}_\alpha)$ and measurable spaces $(X_\alpha,\A_\alpha)$ to be the sets of form \[
    \bigcap_{j=1}^n \pi_{\alpha_{j}}^{-1}(U_{\alpha_j}) \quad \text{and} \quad \bigcap_{j=1}^n \pi_{\alpha_{j}}^{-1}(E_{\alpha_j}),
\] for any $n \in \N$, respectively. To put them into simple words, they are finite intersections of preimages of the projections. The collection of sets in \eqref{eq:1d-cylinder-top} and \eqref{eq:1d-cylinder-sa} are $1$-dimensional cylinders.

The general cylinder sets on the product of topological spaces, as finite\footnote{As another reminder, if the intersection is allowed to be arbitrary, then we get a larger topology called the \df{box topology}. The box topology is generated by arbitrary products of open sets. When the product is finite, the box topology and the product topology coincide.} intersections of subbasic sets in \eqref{eq:1d-cylinder-top}, form a basis for the product topology $\mathcal{T}$. However, it is a well-known fact that $\sigma$-algebras, unlike topologies, cannot be written out explicitly from the elementary sets they are generated from. % Therefore in studying product $\sigma$-algebras, we should work primarily with $1$-dimensional cylinder sets of the form \[
%     E_\beta \times \prod_{\alpha \neq \beta} X_\alpha
% \] over all $\beta \in I$ and $E_\beta \in \A_\beta$.

Looking back at \eqref{eq:1d-cylinder-sa}, you may expect a smaller collection of cylinder sets generates the product $\sigma$-algebra. Yet the proof is a little weird, like most arguments involving algebras of sets.

\begin{prop} \label{prop:prod-s-algebra-generate}
    Suppose each $\A_\alpha$ is generated by $\mathcal{E}_\alpha$. Then $\bigotimes_{\alpha} \A_\alpha$ is generated by the collection \[
        \mathcal{K} = \{\pi_\alpha^{-1} (E_\alpha) : E_\alpha \in \mathcal{E}_\alpha, \alpha \in I\}.
    \]
\end{prop}
\begin{proof}
    Let the collection in \eqref{eq:1d-cylinder-sa} be $\mathcal{J}$. Clearly $\mathcal{K} \subseteq \mathcal{J}$. To see the other inclusion, consider the induced $\sigma$-algebra on $X_\alpha$ \[
        \{E \subseteq X_\alpha : \pi_\alpha^{-1}(E) \in \sigma(\mathcal{K})\},
    \] which contains $\mathcal{E}_\alpha$ and hence $\A_\alpha$. This means $\pi_\alpha^{-1}(E) \in \sigma(\mathcal{K})$ for all $\alpha \in I$ and $E \in \A_\alpha$. Hence $\mathcal{J} \subseteq \sigma(\mathcal{K})$. The proof is now complete.
\end{proof}

We have introduced very general definitions above. The reader should verify on their own that in the case where $I$ is countable, $\A = \bigotimes_{k=1}^\infty \A_k$ is generated by \[
    \biggl\{\prod_{k=1}^\infty E_k :E_k \in \A_k \biggr\}.
\] Also, for measurable spaces $(X_1,\A_1),(X_2,\A_2),\dotsc$, the product $\sigma$-algebra $\A$ is clearly generated from cylinder sets of the form \[
    I_{n,B} = B \times \prod_{k= n+ 1}^\infty X_n\text{, where }B \in \bigotimes_{k=1}^n \A_k.
\] This turns out to be clean to work with.


3.5.1 3.5.2 Bogachev

Since the Borel $\sigma$-algebra is the $\sigma$-algebra generated by open set, while the topological space consists of all the open sets. With our above detailed comparisons between product $\sigma$-algebras and product topological spaces, the Borel $\sigma$-algebra from the product topology and the product Borel $\sigma$-algebra from individual spaces should be the same, under some conditions.

\begin{thm}[{\cite[Lemma~6.4.2]{Bogachev_2007}}] \label{thm:Borel-prod-sigma-prod-top}
    For any second countable spaces $X_1,X_2,\dotsc$ (finite or countably infinite), we have \begin{equation} \label{eq:borel-prod-agreement}
        \B(X) = \B(X_1) \otimes \B(X_2) \otimes \dotsb,
    \end{equation} where $X = X_1 \times X_2 \times \dotsb$ with product topology $\mathcal{T}$.
\end{thm}
\begin{proof}
    We follow the proof in \cite{Kallenberg_2002}\footnote{We cite the second edition of the famous book here. The new proof in the third edition is misleading.}.
    
    Let $\mathcal{J}$ be the class of $1$-dimensional cylinder sets \[
        X_1\times \dotsb \times X_{k-1} \times U_k \times X_{k+1} \times \dotsb
    \] over all $k \in \N$ and $U_k \in \mathcal{T}_k$.
    
    Since $\mathcal{J}$ consists entirely of open sets, and $\text{RHS} = \sigma(\mathcal{J})$ by \cref{prop:prod-s-algebra-generate}, we have $\text{LHS} \supseteq \text{RHS}$. \emph{Note that this inclusion does not use any topological assumptions on the $X_n$'s.}
    
    If we can now show that $\mathcal{T} \subseteq \sigma(\mathcal{J})$, the proof will be complete. Now $(X,\mathcal{T})$, as a countable product of second countable spaces, is still second countable. Here we use a result from topology, included as \cref{fact:Lind-property-2nd-count-space} in the appendix:
    
    \begin{center}
    \noindent\begin{minipage}[t]{0.9\columnwidth}
        Every collection of open sets in a second countable space contains a countable subcollection with the same union.
    \end{minipage}
    \end{center}
    
    Therefore every open set in $X$ is a countable union of basic open sets. Since a topological basis is given by finite intersections of the cylinder sets in $\mathcal{J}$, we then have $\mathcal{T} \subseteq \sigma(\mathcal{J})$.
    % For the countable dense subset $D_k$ of $X_k$, we 
    % Let $\mathcal{T}$ be the product topology on $X_1 \times X_2 \times \dotsb$.Then \[
    %     \text{LHS} = \B(\mathcal{T}).
    % \] Let $\mathcal{C}$ be the collection of $1$-dimensional cylinder sets of the form \[
    %     X_1 \times \dotsb\times X_{k-1}  \times E_k \times X_{k+1} \times \dotsb,
    % \] where $E_k \in \mathcal{T}_k$. Then \[
    %     \text{RHS} = \B(\mathcal{K}).
    % \]
\end{proof}

Specifically, the result above holds for separable metric spaces; in particular, we have $\B(\R^d) = \bigotimes^d \B(\R^1)$. This theorem overall shows the fundamental importance of Borel $\sigma$-algebra in measure theory and its applications: it connects measurability to the underlying topological spaces.

As an exercise, use \cref{prop:measurability-generate} to show the following: 
\begin{xca}[{\cite[Proposition~2.4]{folland1999}}] \label{xca:measurability-proj}
    Given measurable spaces $(X,\M)$ and $(Y_\alpha,\mathcal{N}_\alpha)$ over all $\alpha \in I$. Let $Y = \prod Y_\alpha$ and $\mathcal{N} = \bigotimes \mathcal{N}_\alpha$. Then $f\colon X \to Y$ is $\M/\mathcal{N}$-measurable if and only if each $f_\alpha = \pi_\alpha \circ f$ is $\M/\mathcal{N}_\alpha$-measurable.
\end{xca}

\begin{rem} \label{rem:meas-metric-2nd-countable}
    Say we are given a metric space $(X,\rho)$ with the Borel $\sigma$-algebra. \cref{fact:cont-metric} says $\rho \colon X\times X \to [0,\infty)$ is continuous. 
    It will appear later that we need to integrate this metric function, and therefore we need to ensure measurability of $\rho$ with respect to the product $\sigma$-algebra $\B(X) \otimes \B(X)$.
    
    If we assume $X$ is separable, then by \cref{thm:Borel-prod-sigma-prod-top} we know $\B(X) \otimes \B(X) = \B(X \times X)$, which contains all the open sets in $X \times X$. Hence $\rho$ becomes a measurable function.
\end{rem}

One can already find an application of the above remark in \nameref{thm:Egoroff}, albeit not in the context of integration. We may assume in general $f_n$ and $f$ to take value in a separable metric space there: the measurability of $x \mapsto d\bigl(f_n(x),f(x)\bigr)$ suffices for the proof to work.

\section{Integration on product spaces} \label{sec:prod-integrate}
Let $(X,\M,\mu)$ and $(Y,\mathcal N, \nu)$ be two measure spaces. We need to define a measure on the product space $(X\times Y,\M \otimes \mathcal N)$. It is obvious that such a measure $\pi$ should satisfy the condition that for any pair $A \in \M$ and $B \in \mathcal N$, \begin{equation}
    \lambda (A \times B) = \mu(A)\nu(B). \label{eq:prod-meas-primitive}    
\end{equation}
In this way, the idea of the area of a rectangle carries over our desired measure on the product space.

In fact sets $A \times B$ are often given the name \df{measurable rectangles}, and note that the collection $\mathcal R$ of all such measurable rectangles is a $\pi$-system.

Henceforth we will make the assumption that $\mu$ and $\nu$ are $\sigma$-finite. We need to establish that first, it is possible to extend the definition of $\lambda$ to the entire $\M \otimes \mathcal N$, and get a unique \emph{product measure}, denoted by $\mu \times \nu$. Second, we may compute the integral of a function $f\colon X\times Y\to \R$ (or $\C$) on the product space by doing a double integration with respect to the marginals $dx$ and $dy$, whether you choose to integrate $f(x,y)\,dx$ or $f(x,y)\,dy$ first. 

Define $E_x = \{y \in Y : (x,y)\in E\}$, and similarly define $E^y = \{x \in X : (x,y)\in E\}$. To understand the definition of $E_x$, imagine drawing a line $\{x\}\times Y$, and the proportion that hits $E$ is exactly $E_x$.

For $E \in \M \times \mathcal N$, we have for all $x \in X$ and $y \in Y$, \[
    E_x \in \mathcal N \quad E^y \in \mathcal M.
\] 

folland exercise 12




We reserve the discussion of an extremely important existence results about probability measures on product spaces to \cref{sec:product-prob-meas}. The first of the three results () tells us that there is a \emph{natural} extension of product probability measures over all finite cylinder sets to a product probability measure over the entire product $\sigma$-algebra.
The second and third results () say that if a sequence of probability measures are specified in a \emph{consistent way}, then there is a natural extension of them to a product measure on the entire product $\sigma$-algebra. 

Note that it makes sense to only discuss the countable product of \emph{probability} measures, so that both the coordinate measures, the finite-dimensional product measures. and the countable product measures are all \emph{normalized}. Because of this, and the significance of the existence theorems for product measures in probability, we delay our discussion of these two results despite their purely measure-theoretic statements and proofs.

Many books in probability only include and applies it as a special case

\begin{namedthm}[Fubini--Tonelli theorem] \label{thm:Fubini-Tonelli}
    
\end{namedthm}

\section{Change of variables} \label{sec:cov}

\begin{prop}
    Lipschitz functions maps Lebesgue null sets to Lebesgue null sets. Hence the Lipschitz image of Lebesgue measurable sets is Lebesgue measurable.
\end{prop}

\begin{namedthm}[Sard's theorem]
    Let $A$ be an open subset of $\R^n$. If $\phi\colon A \to \R^m$ is a $C^{n - m + 1}$ map, then the set of critical values of $\phi$ has measure $0$ in $\R^m$.
\end{namedthm}

\begin{namedthm}[Change of variables for injective $C^1$ functions]
    Let $A$ be an open subset of $\R^n$ and $\phi\colon A\to \R^n$ be an injective $C^1$ mapping. Then for any $g\in L^{+}(A)$ or $L^1(A)$, we have \[
        \int_{\phi(A)} g(y)\,dy = \int_A g\bigl(\phi(x)\bigr)\bigl\vert\det D_\phi(x)\bigr\vert\,dx.
    \]
\end{namedthm}


For Lebesgue measurable subset $E$ of $A$, $G(E)$ is also Lebesgue measurable, with \[
    m\bigl(\phi(A)\bigr) = \int_A \abs{\det D_\phi(x)}\,dx.
\]

See \cite[Appendix~F]{Taylor_2006} for the case when $G$ is not even assumed to be injective, and references to further generalizations.

\section{Properties of the product Lebesgue measure}

\begin{namedthm}[Brunn--Minkowski inequality] % Dudley 6.6.1
    For two compact sets in $\R^n$, we have \begin{enumerate}
        \item (additive ver.) $m(A)^{1/n} + m(B)^{1/n}\leq m(A +B)^{1/n}$. 
        \item (multiplicative ver.) $m(A)^{1- \lambda}m(B)^\lambda \leq m\bigl((1-\lambda) A + \lambda B\bigr)$ for any $0 < \lambda < 1$.
    \end{enumerate}
\end{namedthm}

If we substitute $A$ by $(1-\lambda) A$ and $B$ by $\lambda B$, and use the \flcnameref{thm:log-conv-ineq}, then we get the multiplicative version from the additive version. (One can in fact show the two versions are equally strong, which we leave as an exercise.)

The inequality is a direct consequence of the concavity of logarithm.
\begin{namedthm}[Logarithm convexity inequality] \label{thm:log-conv-ineq}
    For $0 < \lambda <1$ and $a,b \geq 0$, we have 
    \[a^{1-\lambda}b^\lambda \leq  (1-\lambda) a + \lambda b,\] which attains equality if and only if $a =b$.
\end{namedthm}






\begin{namedthm}[Prékopa--Leindler inequality]
    
\end{namedthm}

log-concave measure

Gaussian measure

\section{The Gamma function and polar coordinates} 
$\R^n$ and $S^{n-1}$

Cauchy formula for repeated integration

\label{sec:polar}
Let $z \in \C$ with $\Re z > 0$, and we define $f_z\colon (0,\infty)\to \C$ by \[f_z(t) = t^{z-1} e^{-t} = \exp\bigl((z-1)\log t\bigr)\cdot e^{-t}.\] Since 


\begin{thm}
    There is a unique Borel measure $\sigma$ on $S^{n-1}$ such that $m_* = \rho \times \sigma$. If $f\in L^+$ or $L^1$, then we have \[
        \int_{\R^n} f(x)\,dx = \int_{[0,\infty)}\int_{S^{n-1}} f(ry) r^{n-1}\,d\sigma(y)\,dr.
    \]
\end{thm}


$\sigma(S^{n-1})=\frac{2\pi^{n/2}}{\Gamma(n/2)}$ and $m(B^{n})=\frac{1}{n}\sigma(S^{n-1})=\frac{\pi^{n/2}}{\Gamma\bigl(\frac{n}{2}+1\bigr)}$.
For any $\epsilon>0$, we have $S^{n-1}\subseteq B^{n}(0;1+\epsilon)-B^{n}(0;1)$
\begin{align*}
m(S^{n-1}) & \leq m\bigl(B^{n}(0;1+\epsilon)\bigr)-m\bigl(B^{n}(0;1)\bigr)\\
 & \leq(1+\epsilon)^{n}m(B^{n})-m(B^{n}).
\end{align*}
Take $\epsilon\to0^{+}$, it is easy to see that $m(S^{n-1})=0$.
surface area